/*
 * USART.c
 *
 *  Created on: Jan 26, 2015
 *      Author: joest
 */


#include "RBELib/RBELib.h"
//#include <avr/io.h>

void debugUSARTInit(unsigned long baudrate){
  baudrate = 1843200/16/(baudrate-1);
  UBRR1H = (unsigned char) (baudrate>>8);
  UBRR1L = (unsigned char) baudrate;

  UCSR1B = (1<<RXEN1) | (1<<TXEN1);
  
  UCSR1C = (1<<USBS1) | (3<<UCSZ10);
  PORTC = 0x0F;
  _delay_ms(1000);
}

void putCharDebug(char byteToSend){
 while ( !(UCSR1A & (1<<UDRE1)));
 PORTC = 0xF0;
 _delay_ms(500);
 UDR1  = byteToSend;
 PORTC = 0x00;
}

unsigned char getCharDebug(void) {
   while (!(UCSR1A & (1<<RXC1)));
   return UDR1;
}
